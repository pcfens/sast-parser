<html lang="en">
    <head>
        <title>Vulnerability Report</title>
        <script src="https://cdn.plot.ly/plotly-2.29.1.min.js" charset="utf-8"></script>
    </head>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        td.Critical{
            background-color: rgba(255, 0, 0, 1);
        }
        td.High{
            background-color: rgba(255, 165, 0, 1 );
        }
        td.Medium{
            background-color: rgba(218, 255, 0, 1);
        }
        td.Low{
            background-color: rgba(0, 218, 255, 1);
        }
        td.Unknown{
            background-color: rgba(191, 227, 180, 1);
        }
    </style>
    <body>
        <h1>Vulnerability Report</h1>

        <div id="chart"></div>

        <table>
            <tr>
                <th>Row #</th>
                <th>Severity</th>
                <th>Confidence</th>
                <th>Message</th>
                <th>Description</th>
                <th>Location</th>
            </tr>
            {% for vuln in vulnerabilities|sort(attribute='severity') -%}
            <tr class="{{vuln.severity}}">
                <td>{{loop.index}}</td>
                <td class="{{vuln.severity}}">{{vuln.severity}}</td>
                <td>{{vuln.confidence}}</td>
                <td>{{vuln.message}}</td>
                <td>{{vuln.description}}</td>
                <td>{{vuln.location.file}}{% if vuln.location.start_line %}:{{vuln.location.start_line}}{% if vuln.location.end_line and vuln.location.start_line < vuln.location.end_line %} - {{vuln.location.end_line}}{% endif %}{% endif %}</td>
            </tr>
            {% endfor -%}
        </table>

        <script type="text/javascript">
            var data = [
                {
                    x: {{frequencies.keys()|list|safe}},
                    y: {{frequencies.values()|list|safe}},
                    marker: {
                        color: [ 'rgba(255, 0, 0, 1)', 'rgba(255, 165, 0, 1 )', 'rgba(218, 255, 0, 1)', 'rgba(0, 218, 255, 1)', 'rgba(191, 227, 180, 1)']
                    },
                    type: 'bar'
                }
            ];

            var layout = {
                xaxis: {fixedrange: true},
                yaxis: {fixedrange: true}
            };

            Plotly.newPlot('chart', data, layout, {displayModeBar: false, responsive: true, scrollZoom: false});
        </script>
    </body>
</html>